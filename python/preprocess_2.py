''' set up '''
# Common imports
import pandas as pd
import matplotlib
import matplotlib.pyplot as plt
import numpy as np
import os
from skimage.transform import resize
from scipy import io
import pickle
%matplotlib inline

'''Load Data'''  
train_labels = pd.read_csv('C:/Users/wuh00/OneDrive/Desktop/SPRING_2019/ECE595_ML/Project_1/trainLabels.csv',
                           header=0, low_memory=False)
data = io.loadmat('C:/Users/wuh00/OneDrive/Desktop/SPRING_2019/ECE595_ML/Project_1/all_train_files.mat')
all_images = data['all_images']
filename = data['filename']

N = train_labels.iloc[:,0]
M = train_labels.iloc[:,1]

label = np.zeros((all_images.shape[0], 1),float)
filename_df = pd.DataFrame(filename)
filename_df = filename_df.astype(str)

for i in range(filename_df.shape[1]):
    filename_df[i] = filename_df[i].str.replace('[',' ')
    filename_df[i] = filename_df[i].str.replace(']','')
    filename_df[i] = filename_df[i].str.split('.').str[0]
    filename_df[i] = filename_df[i].str.replace('\'','')
    filename_df[i] = filename_df[i].str.replace(' ','')
print(filename_df)

'''for better implementation'''  
filename_df = filename_df.transpose()
print(filename_df)
print(N)

'''find corresponding label for each image pattern by searching filenames'''  
for i in range(filename_df.shape[0]):
    a = filename_df[filename_df.iloc[:,0] == N[i]].index.tolist()
    label[i] = a
print(label)
print(all_images.shape)

'''image normalization'''
from sklearn import preprocessing
min_max_scaler = preprocessing.MinMaxScaler()
all_images_normalized = min_max_scaler.fit_transform(all_images)
print(all_images_normalized)
print(all_images_normalized.shape)
io.savemat('C:/Users/wuh00/OneDrive/Desktop/SPRING_2019/ECE595_ML/Project_1/train_data.mat', [all_images_normalized,label])